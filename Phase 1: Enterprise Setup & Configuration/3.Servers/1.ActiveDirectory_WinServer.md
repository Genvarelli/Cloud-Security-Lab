# Windows Server 2025 - Active Directory Setup

## What is Active Directory?

**Active Directory (AD)** is Microsoft’s directory service used to manage users, devices, and resources on a network. It functions as a **centralised database** to:

- **Authenticate** users (verify their identity)
- **Authorise** access (grant or deny permissions)
- **Manage** network resources (users, devices, and policies)

---

## Why Use Active Directory?

AD is a core part of enterprise networks because it:

- 🔧 **Centralises management** of users, devices, and permissions  
- 📈 **Scales easily** — from small businesses to global organisations  
- 🔐 **Secures authentication and authorisation** using protocols like **Kerberos** and **LDAP**  
- 🛠️ **Applies system-wide settings** via **Group Policy Objects (GPOs)**  
- 🔗 **Integrates** with services such as **Microsoft Exchange**, **Azure AD**, and more

---

## Core Concepts in Active Directory

| Concept | Description |
|--------|-------------|
| **Domain** | A logical group of users/devices that share authentication and policy settings. <br>🧪 *This project uses:* `corp.project-x-dc.com` |
| **Domain Controller (DC)** | A server that stores the AD database and handles login/authentication |
| **Organisational Units (OUs)** | Folders within a domain used to logically organise AD objects (e.g., HR, IT, Finance) |
| **Objects** | Everything in AD: users, computers, printers, groups, etc. |
| **Groups** | Manage access and communication:<br>- **Security Groups**: For permissions<br>- **Distribution Groups**: For email |
| **Forest & Trees** | **Forest** = A collection of domains with a shared schema<br>**Tree** = A hierarchy of related domains |
| **Global Catalogue (GC)** | Indexes all AD objects in the forest for faster searches |
| **Trust Relationships** | Allow users in one domain to access resources in another |

---

## Security Considerations

Because AD controls key systems, it's a high-value target for attackers.

### 🔒 Common Threats:

- **Credential Theft** – Techniques like *Pass-the-Hash* or *Kerberoasting*
- **Privilege Escalation** – Gaining unauthorised access via misconfigured permissions
- **Lateral Movement** – Navigating across the network after initial compromise

---

## Hybrid vs On-Premises AD

Many organisations now use **hybrid identity systems** with **Microsoft Entra ID** (formerly Azure AD), combining on-premises and cloud-based authentication.

For this project, we’re using a **fully on-premises setup** to:
- Maintain full control
- Avoid cloud costs
- Provide a secure, isolated lab environment

> The interface and naming may differ slightly from cloud systems, but the **core concepts remain the same**.

---

## Windows Server 2022 Setup

1. Click “Next” ➔ “Install Windows 11” ➔ Tick the checkbox ➔ “Next”  
   ![window server Install](imgs/winserver.jpg)  
   ![window server Install](imgs/winserver1.jpg)

2. Select the **Desktop Experience** version  
   ![window server GUI](imgs/winserver2.png)

3. Accept the EULA ➔ Click “Next”

4. Select **Disk 0 Unallocated Space** ➔ Click “Create Partition”  
   Use the default size ➔ Click “Apply”

5. Wait until partitions appear  
   > 💡 **Note**: Partitions divide disk space to help separate system and data files.

6. Choose **Disk 0 Partition 2** (the largest one)  
   ![Disk Partition](imgs/winserver3.png)

7. Click “Install”  
   ![Install](imgs/winserver4.png)

8. Wait for installation to finish. The server will restart.  
   ![Reboot](imgs/winserver5.png)

---

### First Boot

1. Set a password for the **Administrator** account  
   Password: `Mr.Robot1`  
   ![Login Prompt](imgs/loginprompt.jpg)

2. Login screen appears  
   ![Login Prompt](imgs/loginprompt1.jpg)

> 💡 Use **VirtualBox** > **Input > Keyboard > Insert Ctrl+Alt+Del** if needed  
   ![Input](imgs/input.jpg)

3. After signing in, **Server Manager** opens  
   ![Server Manager](imgs/servermanager.jpg)

---

### Post-Setup Configuration

- **Disable screen timeout**  
  Navigate to **Settings > Power & Battery > Screen Timeout** ➔ Set to **Never**

- **Disable Ctrl+Alt+Del login**  
  Go to `Computer Configuration > Windows Settings > Security Settings > Local Policies > Security Options`  
  Enable **Interactive login: Do not require Ctrl+Alt+Del**  
  ![Interactive Login](imgs/ad8.png)

---

### Assign a Static IP Address

1. Go to **Control Panel > Network and Sharing Centre > Change adapter settings**

2. Right-click **Ethernet** ➔ **Properties**

3. Select **Internet Protocol Version 4 (TCP/IPv4)** ➔ Click **Properties**

4. Enter the following details:
   - IP Address: `10.0.0.5`
   - Subnet Mask: `255.255.255.0`
   - Default Gateway: `10.0.0.1`  
   ![Network Connections](imgs/networkconnections1.png)

---

## Promote Server to a Domain Controller

1. In **Server Manager**, click **Add Roles and Features**  
   ![Add Roles and Features](imgs/roles.jpg)

2. Click **Next** through prerequisites  
   ![pre-req](imgs/prereq.jpg)  
   ![Role-based](imgs/Role-based.jpg)  
   ![Destination](imgs/dest.jpg)

3. Target the local server (`10.0.0.5`) and install these roles:
   - **Active Directory Domain Services**
   - **DHCP Server**
   - **DNS Server**  
   ![Active Directory](imgs/installadds.png)  
   ![DHCP](imgs/dhcpserver.png)  
   ![DNS](imgs/dnsserver.png)

4. Click **Install** and wait for completion  
   ![Installation Progress](imgs/installationprogress.png)

---

### Promote to Domain Controller

1. Open **Server Manager > AD DS** ➔ Click **More...**  
   ![Server Manager](imgs/servermanager.png)

2. Click **Promote this server to a domain controller**  
   ![Promote](imgs/promoteadds.png)

3. Select **Add a new forest** ➔ Domain: `corp.skynet-dc.com`  
   ![New Forest](imgs/addnewforest.png)

4. Leave default settings ➔ Set **DSRM password**  
   ![DSRM Password](imgs/domainpassword.png)

5. Keep NetBIOS name as `CORP` ➔ Proceed to **Install**  
   ![Install](imgs/promoteadds2.png)

6. The server restarts after installation

---

### Verify Domain Setup

After reboot, login prompt shows: `CORP\Administrator`  
![CORP](imgs/corp.jpg)

---

### Configure DNS Forwarding

1. Open **Server Manager > DNS**  
   ![DNS](imgs/dnssetup1.png)

2. Launch **DNS Manager**  
   ![DNS](imgs/dnssetup2.png)

3. Right-click the server ➔ **Properties**  
   ![DNS](imgs/dnssetup3.png)

4. Go to **Forwarders** tab ➔ Click **Edit**  
   ![DNS](imgs/dnssetup4.png)

5. Add `8.8.8.8` (Google DNS) ➔ Click **OK** and **Apply**  
   ![DNS](imgs/dnssetup5.png)

---

### Test DNS Resolution

Open **PowerShell**:

- `ping google.com` ➔ Should return replies  
  ![Ping](imgs/pinggoogle.png)

- `nslookup google.com` ➔ Should resolve IP  
  ![NSLookup](imgs/nslookup.png)

---

## Set Up DHCP

Even though static IPs are mostly used, DHCP is configured for flexibility.

### Create a DHCP Scope

1. Open **Server Manager > DHCP** ➔ Launch **DHCP Manager**  
   ![DHCP](imgs/dhcp.png)

2. Right-click **IPv4** ➔ **New Scope**  
   ![New Scope](imgs/dhcp1.png)

3. Name: `skynet-scope`

4. IP Range:
   - Start: `10.0.0.100`
   - End: `10.0.0.200`
   - Subnet Mask: `255.255.255.0`  
   ![Scope Settings](imgs/dhcp2.png)

5. Skip exclusions ➔ Lease Duration: **8 days**

6. Configure options now:
   - Default Gateway: `10.0.0.1`  
     ![Gateway](imgs/dhcp3.png)

7. Skip DNS/WINS ➔ Activate scope ➔ Finish

---

### Finalise DHCP Setup

1. In **Server Manager**, click **More...** under DHCP alert

2. Click **Complete DHCP Configuration**  
   ![DHCP Final](imgs/dhcp4.png)  
   ![DHCP Final](imgs/dhcp5.png)

3. Click **Next**, then **Commit**, then **Close**

---

## Create Active Directory User Accounts

These accounts allow users to sign into domain-joined machines.

Open AD Users and Computers

1. In **Server Manager**, go to **Tools > Active Directory Users and Computers**  
   ![Tools](imgs/tools.png)

2. Expand the domain tree ➔ Select **Users**

Create User – John Doe

3. Right-click **Users** ➔ **New > User**  
   ![Users](imgs/users.png)

4. Fill in:
   - First Name: John
   - Last Name: Doe
   - Logon Name: `john.doe`  
     ![Users](imgs/user1.png)

5. Password settings:
   - Uncheck: "User must change password at next logon"
   - Check: "User cannot change password"

Create User – Jane Doe

6. Repeat the steps above:
- First Name: Jane
- Last Name: Doe
- Logon Name: `jane.doe`  
  ![Users Created](imgs/users_created.png)

Use the password from the project overview ➔ Click **Next** and **Finish**

---

## Take a VM Snapshot (Baseline)

1. In **VirtualBox**, go to **Machine > Take Snapshot**

2. Name it: `base` — This becomes your **baseline configuration**  
   ![baseline configuration](imgs/vbox_snapshot_base.png)

---

## ✅ Final Status

Your **Windows Server 2022 VM** is now fully configured as a **Domain Controller**, running:

- ✅ Active Directory Domain Services (AD DS)  
- ✅ DNS  
- ✅ DHCP  

It is ready to manage users, devices, and network policies within the Skynet lab environment.
